{% load static %}
{% url 'home' as home_url %}
{% url 'contact' as contact_url %}
{% url 'products:list' as product_list_url %}
{% url 'login' as login_url %}
{% url 'logout' as logout_url %}
{% url 'register' as register_url %}
{% url 'cart:home' as cart_url %}
<nav class="navbar navbar-expand-lg sticky-top navbar-dark bg-dark mb-3">
<div class="container">
  <a class="navbar-brand" href="{{ home_url }}"><i class="fab fa-lg fa-github" style="color:white;margin-right: 4px"></i><b>{{ brand_name }}</b></a>
  <button class="navbar-toggler" type="button" data-toggle="collapse"
  data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
  aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>
  <div class="collapse navbar-collapse" id="navbarSupportedContent">
    <ul class="navbar-nav mr-auto">
      <li class="nav-item {% if request.path == home_url %} active{% endif %}">
        <a class="nav-link" href="{{ home_url }}">Home<span class="sr-only">(current)</span></a>
      </li>
      <li class="nav-item {% if request.path == contact_url %} active{% endif %}">
        <a class="nav-link" href="{{ contact_url }}">Contact</a>
      </li>

      <li class="nav-item {% if request.path == product_list_url %} active{% endif %}">
        <a class="nav-link" href="{{ product_list_url }}">Products</a>
      </li>
      <li class="nav-item {% if request.path == cart_url %} active{% endif %}">
        <a class="nav-link" href="{{ cart_url }}"><span class="navbar-cart-count">{{ request.session.cart_items }}</span><i class="fa fa-shopping-cart"></i></a>
      </li>
      
      {% if request.user.is_authenticated %}
        <!-- Admin Navigation -->
        {% if request.user.is_admin %}
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" id="adminDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            <i class="fas fa-cog"></i> Admin
          </a>
          <div class="dropdown-menu" aria-labelledby="adminDropdown">
            <a class="dropdown-item" href="/admin/"><i class="fas fa-tachometer-alt"></i> Django Admin</a>
            <div class="dropdown-divider"></div>
            <h6 class="dropdown-header">User Management</h6>
            <a class="dropdown-item" href="/admin/accounts/user/"><i class="fas fa-users"></i> Manage Users</a>
            <a class="dropdown-item" href="/admin/accounts/user/add/"><i class="fas fa-user-plus"></i> Add User</a>
            <div class="dropdown-divider"></div>
            <h6 class="dropdown-header">Product Management</h6>
            <a class="dropdown-item" href="/admin/products/product/"><i class="fas fa-box"></i> All Products</a>
            <a class="dropdown-item" href="/admin/products/product/add/"><i class="fas fa-plus"></i> Add Product</a>
            <div class="dropdown-divider"></div>
            <h6 class="dropdown-header">Order Management</h6>
            <a class="dropdown-item" href="/admin/orders/order/"><i class="fas fa-shopping-bag"></i> All Orders</a>
            <a class="dropdown-item" href="/admin/billing/billingprofile/"><i class="fas fa-credit-card"></i> Billing Profiles</a>
          </div>
        </li>
        {% endif %}
        
        <!-- Merchant Navigation -->
        {% if request.user.is_merchant %}
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" id="merchantDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            <i class="fas fa-store"></i> Merchant
          </a>
          <div class="dropdown-menu" aria-labelledby="merchantDropdown">
            <a class="dropdown-item" href="{% url 'merchants:dashboard' %}"><i class="fas fa-tachometer-alt"></i> Dashboard</a>
            <div class="dropdown-divider"></div>
            <h6 class="dropdown-header">Product Management</h6>
            <a class="dropdown-item" href="{% url 'merchants:product_list' %}"><i class="fas fa-list"></i> My Products</a>
            <a class="dropdown-item" href="{% url 'merchants:product_create' %}"><i class="fas fa-plus"></i> Add Product</a>
            <div class="dropdown-divider"></div>
            <h6 class="dropdown-header">Quick Actions</h6>
            <a class="dropdown-item" href="{% url 'merchants:product_list' %}?status=active"><i class="fas fa-eye"></i> Active Products</a>
            <a class="dropdown-item" href="{% url 'merchants:product_list' %}?status=inactive"><i class="fas fa-eye-slash"></i> Inactive Products</a>
          </div>
        </li>
        {% endif %}
        
        <!-- User Account Navigation -->
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" id="userDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            <i class="fas fa-user"></i> {{ request.user.get_full_name|default:request.user.email|truncatechars:15 }}
          </a>
          <div class="dropdown-menu" aria-labelledby="userDropdown">
            <h6 class="dropdown-header">Account</h6>
            <a class="dropdown-item" href="{% url 'user_profile' %}"><i class="fas fa-user-circle"></i> Profile</a>
            <a class="dropdown-item" href="{% url 'user_addresses' %}"><i class="fas fa-map-marker-alt"></i> Addresses</a>
            <a class="dropdown-item" href="{% url 'user_order_history' %}"><i class="fas fa-history"></i> Order History</a>
            <div class="dropdown-divider"></div>
            <a class="dropdown-item" href="{{ logout_url }}"><i class="fas fa-sign-out-alt"></i> Logout</a>
            <div class="dropdown-divider"></div>
            <small class="dropdown-item-text text-muted">
              Role: 
              {% if request.user.is_admin %}
                <span class="badge badge-danger">Admin</span>
              {% elif request.user.is_merchant %}
                <span class="badge badge-success">Merchant</span>
              {% else %}
                <span class="badge badge-primary">Customer</span>
              {% endif %}
            </small>
          </div>
        </li>
      {% endif %}
      {% if not request.user.is_authenticated %}
      <li class="nav-item {% if request.path == register_url %} active{% endif %}">
        <a class="nav-link" href="{{ register_url }}"><i class="fas fa-user-plus"></i> Register</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="{% url 'merchant_register' %}"><i class="fas fa-store"></i> Become Merchant</a>
      </li>
      <li class="nav-item {% if request.path == login_url %} active{% endif %}">
        <a class="nav-link" href="{{ login_url }}"><i class="fas fa-sign-in-alt"></i> Login</a>
      </li>
      {% endif %}
    </ul>
    {% include 'search/snippets/search-form.html'  %}
      </div>
  </div>
</nav>
